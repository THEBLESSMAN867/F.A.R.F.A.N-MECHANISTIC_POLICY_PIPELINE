# Path Audit Report

**Generated by:** `scripts/audit_paths.py`
**Repository:** /Users/recovered/F.A.R.F.A.N-MECHANISTIC_POLICY_PIPELINE_FINAL/F.A.R.F.A.N-MECHANISTIC_POLICY_PIPELINE_FINAL

## Executive Summary

- **Files Scanned:** 422
- **Total Findings:** 108
- **Critical:** 0
- **High:** 0
- **Medium:** 108
- **Low:** 0

## Findings by Severity

### MEDIUM (108)

#### cwd_usage (1 occurrences)

- **scripts/audit_paths.py:222**
  - Current working directory usage - fragile in different execution contexts
  - Code: `# os.getcwd() or Path.cwd()`
  - Fix: Use proj_root() or explicit paths from saaaaaa.utils.paths

#### file_usage (52 occurrences)

- **setup.py:29**
  - __file__ usage detected - may break in packaged distributions
  - Code: `PROJECT_ROOT = Path(__file__).resolve().parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tools/scan_core_purity.py:19**
  - __file__ usage detected - may break in packaged distributions
  - Code: `PROJECT_ROOT = Path(__file__).resolve().parents[1]`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tools/grep_boundary_checks.py:13**
  - __file__ usage detected - may break in packaged distributions
  - Code: `PROJECT_ROOT = Path(__file__).resolve().parents[1]`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_dependency_management.py:277**
  - __file__ usage detected - may break in packaged distributions
  - Code: `script_path = Path(__file__).parent.parent / "scripts" / "generate_dependency_files.py"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_dependency_management.py:289**
  - __file__ usage detected - may break in packaged distributions
  - Code: `script = Path(__file__).parent.parent / "scripts" / "compare_freeze_lock.py"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_dependency_management.py:311**
  - __file__ usage detected - may break in packaged distributions
  - Code: `script = Path(__file__).parent.parent / "scripts" / "compare_freeze_lock.py"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/validate_spc_implementation.py:13**
  - __file__ usage detected - may break in packaged distributions
  - Code: `REPO_ROOT = Path(__file__).parent.parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_strategic_wiring.py:41**
  - __file__ usage detected - may break in packaged distributions
  - Code: `root_dir = Path(__file__).parent.parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_strategic_wiring.py:71**
  - __file__ usage detected - may break in packaged distributions
  - Code: `root = Path(__file__).parent.parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_strategic_wiring.py:81**
  - __file__ usage detected - may break in packaged distributions
  - Code: `root = Path(__file__).parent.parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

  ... and 42 more occurrences

#### hardcoded_separator (55 occurrences)

- **tests/test_wiring_core.py:372**
  - Potential hardcoded path separator detected
  - Code: `client = SignalClient(base_url="memory://")`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_questionnaire_validation_edge_cases.py:290**
  - Potential hardcoded path separator detected
  - Code: `'base_slot': f'D{i//5 + 1}-Q{i%5 + 1}'`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_signals.py:336**
  - Potential hardcoded path separator detected
  - Code: `client = SignalClient(base_url="memory://")`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_signals.py:350**
  - Potential hardcoded path separator detected
  - Code: `client = SignalClient(base_url="memory://")`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_signals.py:358**
  - Potential hardcoded path separator detected
  - Code: `client = SignalClient(base_url="memory://")`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_signals.py:746**
  - Potential hardcoded path separator detected
  - Code: `client = SignalClient(base_url="memory://")`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_signals.py:766**
  - Potential hardcoded path separator detected
  - Code: `"""Test that HTTP URL without enable_http_signals flag falls back to memory://."""`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_signals.py:779**
  - Potential hardcoded path separator detected
  - Code: `SignalClient(base_url="ftp://localhost")`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_flux_contracts.py:66**
  - Potential hardcoded path separator detected
  - Code: `manifest = DocManifest(document_id="test-doc", source_uri="test://uri")`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_policy_orchestration_e2e.py:27**
  - Potential hardcoded path separator detected
  - Code: `regex=["\\bmujeres?\\b", "\\bg√©nero\\b"],`
  - Fix: Use Path.joinpath() or / operator

  ... and 45 more occurrences

## Findings by Category

### hardcoded_separator: 55 occurrences

### file_usage: 52 occurrences

### cwd_usage: 1 occurrences


## Recommendations

1. **Eliminate sys.path manipulation**: Use proper package imports
2. **Remove absolute paths**: Use `proj_root()`, `data_dir()`, etc. from `saaaaaa.utils.paths`
3. **Replace os.path with pathlib.Path**: More portable and Pythonic
4. **Use resources() for packaged data**: Ensures compatibility with wheels/sdist
5. **Validate all path operations**: Use `validate_read_path()` and `validate_write_path()`
6. **Add path traversal protection**: Use `safe_join()` for user-provided paths
7. **Use temp_dir() instead of hardcoded /tmp**: Ensures controlled cleanup

## Next Steps

1. Create tests under `tests/paths/` to enforce these rules
2. Fix critical and high severity issues first
3. Add pre-commit hooks to prevent regressions
4. Update CI to test on Windows, macOS, and Linux
5. Document path handling guidelines in README
