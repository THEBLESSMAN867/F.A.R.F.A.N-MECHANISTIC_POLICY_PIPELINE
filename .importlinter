[settings]
root_package = farfan_pipeline

# POLICY: Absolute imports only
# All imports within farfan_pipeline must use absolute imports (e.g., from farfan_pipeline.core import x)
# Relative imports (e.g., from . import x, from .. import y) are forbidden.
# This is enforced by the CI pipeline via scripts/validate_no_relative_imports.py

[contract:core-foundation]
name = Core must stay independent
type = forbid
source_modules =
    farfan_pipeline.core
forbidden_modules =
    farfan_pipeline.core.orchestrator
    farfan_pipeline.analysis
    farfan_pipeline.processing
    farfan_pipeline.api

[contract:orchestrator-depends-core]
name = Orchestrator may depend on core but not vice versa
type = independence
modules =
    farfan_pipeline.core.orchestrator
    farfan_pipeline.core

[contract:processing-no-orchestrator]
name = Processing layer cannot import orchestrator
type = forbid
source_modules =
    farfan_pipeline.processing
forbidden_modules =
    farfan_pipeline.core.orchestrator

[contract:analysis-no-orchestrator]
name = Analysis layer cannot import orchestrator
type = forbid
source_modules =
    farfan_pipeline.analysis
forbidden_modules =
    farfan_pipeline.core.orchestrator

[contract:analysis-dep-core]
name = Analysis depends on core but not infrastructure
type = forbid
source_modules =
    farfan_pipeline.analysis
forbidden_modules =
    farfan_pipeline.infrastructure

[contract:infrastructure-no-orchestrator]
name = Infrastructure must not pull orchestrator
type = forbid
source_modules =
    farfan_pipeline.infrastructure
forbidden_modules =
    farfan_pipeline.core.orchestrator

[contract:api-boundaries]
name = API layer only calls orchestrator entry points
type = forbid
source_modules =
    farfan_pipeline.api
forbidden_modules =
    farfan_pipeline.processing
    farfan_pipeline.analysis
    farfan_pipeline.utils

[contract:utils-leaf]
name = Utils stay leaf modules
type = forbid
source_modules =
    farfan_pipeline.utils
forbidden_modules =
    farfan_pipeline.core.orchestrator
    farfan_pipeline.processing
    farfan_pipeline.analysis
