# Path Audit Report

**Generated by:** `scripts/audit_paths.py`
**Repository:** /Users/recovered/Library/CloudStorage/OneDrive-DefensoriadelPueblo/F.A.R.F.A.N-MECHANISTIC_POLICY_PIPELINE_

## Executive Summary

- **Files Scanned:** 422
- **Total Findings:** 164
- **Critical:** 0
- **High:** 0
- **Medium:** 163
- **Low:** 1

## Findings by Severity

### MEDIUM (163)

#### cwd_usage (5 occurrences)

- **scripts/audit_paths.py:215**
  - Current working directory usage - fragile in different execution contexts
  - Code: `# os.getcwd() or Path.cwd()`
  - Fix: Use proj_root() or explicit paths from saaaaaa.utils.paths

- **src/saaaaaa/config/paths.py:57**
  - Current working directory usage - fragile in different execution contexts
  - Code: `return Path.cwd()`
  - Fix: Use proj_root() or explicit paths from saaaaaa.utils.paths

- **src/saaaaaa/audit/audit_system.py:927**
  - Current working directory usage - fragile in different execution contexts
  - Code: `default=Path.cwd(),`
  - Fix: Use proj_root() or explicit paths from saaaaaa.utils.paths

- **src/saaaaaa/core/orchestrator/core.py:1494**
  - Current working directory usage - fragile in different execution contexts
  - Code: `candidates.append(os.path.join(os.getcwd(), path))`
  - Fix: Use proj_root() or explicit paths from saaaaaa.utils.paths

- **src/saaaaaa/core/orchestrator/core.py:1496**
  - Current working directory usage - fragile in different execution contexts
  - Code: `candidates.append(os.path.join(os.getcwd(), "rules", "METODOS", path))`
  - Fix: Use proj_root() or explicit paths from saaaaaa.utils.paths

#### file_usage (51 occurrences)

- **setup.py:27**
  - __file__ usage detected - may break in packaged distributions
  - Code: `readme_file = Path(__file__).parent / "README.md"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tools/grep_boundary_checks.py:13**
  - __file__ usage detected - may break in packaged distributions
  - Code: `REPO_ROOT = Path(__file__).resolve().parent.parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_dependency_management.py:21**
  - __file__ usage detected - may break in packaged distributions
  - Code: `return Path(__file__).parent.parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_dependency_management.py:275**
  - __file__ usage detected - may break in packaged distributions
  - Code: `script_path = Path(__file__).parent.parent / "scripts" / "generate_dependency_files.py"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_dependency_management.py:287**
  - __file__ usage detected - may break in packaged distributions
  - Code: `script = Path(__file__).parent.parent / "scripts" / "compare_freeze_lock.py"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_dependency_management.py:309**
  - __file__ usage detected - may break in packaged distributions
  - Code: `script = Path(__file__).parent.parent / "scripts" / "compare_freeze_lock.py"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_structure_verification.py:16**
  - __file__ usage detected - may break in packaged distributions
  - Code: `repo_root = Path(__file__).parent.parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_proof_generator.py:72**
  - __file__ usage detected - may break in packaged distributions
  - Code: `src_root = Path(__file__).parent.parent / "src" / "saaaaaa"`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/validate_spc_implementation.py:13**
  - __file__ usage detected - may break in packaged distributions
  - Code: `REPO_ROOT = Path(__file__).parent.parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

- **tests/test_strategic_wiring.py:41**
  - __file__ usage detected - may break in packaged distributions
  - Code: `root_dir = Path(__file__).parent.parent`
  - Fix: Use resources() for packaged data or proj_root() for workspace-relative paths

  ... and 41 more occurrences

#### hardcoded_separator (101 occurrences)

- **setup.py:75**
  - Potential hardcoded path separator detected
  - Code: `url="https://github.com/kkkkknhh/SAAAAAA",`
  - Fix: Use Path.joinpath() or / operator

- **setup.py:77**
  - Potential hardcoded path separator detected
  - Code: `"Bug Tracker": "https://github.com/kkkkknhh/SAAAAAA/issues",`
  - Fix: Use Path.joinpath() or / operator

- **setup.py:78**
  - Potential hardcoded path separator detected
  - Code: `"Documentation": "https://github.com/kkkkknhh/SAAAAAA#readme",`
  - Fix: Use Path.joinpath() or / operator

- **setup.py:79**
  - Potential hardcoded path separator detected
  - Code: `"Source Code": "https://github.com/kkkkknhh/SAAAAAA",`
  - Fix: Use Path.joinpath() or / operator

- **tools/scan_boundaries.py:185**
  - Potential hardcoded path separator detected
  - Code: `"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.`
  - Fix: Use Path.joinpath() or / operator

- **tools/scan_boundaries.py:192**
  - Potential hardcoded path separator detected
  - Code: `"informationUri": "https://github.com/kkkkknhh/SAAAAAA",`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_questionnaire_validation_edge_cases.py:290**
  - Potential hardcoded path separator detected
  - Code: `'base_slot': f'D{i//5 + 1}-Q{i%5 + 1}'`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_signals.py:335**
  - Potential hardcoded path separator detected
  - Code: `"""Test signal client in memory:// mode."""`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_signals.py:336**
  - Potential hardcoded path separator detected
  - Code: `client = SignalClient(base_url="memory://")`
  - Fix: Use Path.joinpath() or / operator

- **tests/test_signals.py:349**
  - Potential hardcoded path separator detected
  - Code: `"""Test signal client memory:// miss."""`
  - Fix: Use Path.joinpath() or / operator

  ... and 91 more occurrences

#### os_path_usage (6 occurrences)

- **scripts/smart_policy_chunks_canonic_phase_one.py:3262**
  - os.path usage detected
  - Code: `output_dir = os.path.dirname(args.output) or '.'`
  - Fix: Use pathlib.Path instead of os.path

- **src/saaaaaa/compat/native_check.py:120**
  - os.path usage detected
  - Code: `dll_path = os.path.join(path_dir, f"{libname}.dll")`
  - Fix: Use pathlib.Path instead of os.path

- **src/saaaaaa/core/orchestrator/core.py:1492**
  - os.path usage detected
  - Code: `base_dir = os.path.dirname(__file__)`
  - Fix: Use pathlib.Path instead of os.path

- **src/saaaaaa/core/orchestrator/core.py:1493**
  - os.path usage detected
  - Code: `candidates.append(os.path.join(base_dir, path))`
  - Fix: Use pathlib.Path instead of os.path

- **src/saaaaaa/core/orchestrator/core.py:1494**
  - os.path usage detected
  - Code: `candidates.append(os.path.join(os.getcwd(), path))`
  - Fix: Use pathlib.Path instead of os.path

- **src/saaaaaa/core/orchestrator/core.py:1496**
  - os.path usage detected
  - Code: `candidates.append(os.path.join(os.getcwd(), "rules", "METODOS", path))`
  - Fix: Use pathlib.Path instead of os.path

### LOW (1)

#### open_without_context (1 occurrences)

- **tools/testing/generate_synthetic_traffic.py:247**
  - open() call - verify proper resource cleanup
  - Code: `open(args.output, 'w').close()`
  - Fix: Consider using 'with open(...)' for automatic cleanup

## Findings by Category

### hardcoded_separator: 101 occurrences

### file_usage: 51 occurrences

### os_path_usage: 6 occurrences

### cwd_usage: 5 occurrences

### open_without_context: 1 occurrences


## Recommendations

1. **Eliminate sys.path manipulation**: Use proper package imports
2. **Remove absolute paths**: Use `proj_root()`, `data_dir()`, etc. from `saaaaaa.utils.paths`
3. **Replace os.path with pathlib.Path**: More portable and Pythonic
4. **Use resources() for packaged data**: Ensures compatibility with wheels/sdist
5. **Validate all path operations**: Use `validate_read_path()` and `validate_write_path()`
6. **Add path traversal protection**: Use `safe_join()` for user-provided paths
7. **Use temp_dir() instead of hardcoded /tmp**: Ensures controlled cleanup

## Next Steps

1. Create tests under `tests/paths/` to enforce these rules
2. Fix critical and high severity issues first
3. Add pre-commit hooks to prevent regressions
4. Update CI to test on Windows, macOS, and Linux
5. Document path handling guidelines in README
